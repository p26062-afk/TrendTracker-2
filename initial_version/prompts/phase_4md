## Phase 4: ì €ì¥ì†Œ ë ˆì´ì–´ - CSV ë°ì´í„° ê´€ë¦¬ (7ë‹¨ê³„ ì¤‘ 4ë‹¨ê³„)

---

Phase 4: ê²€ìƒ‰ ê²°ê³¼ë¥¼ CSV íŒŒì¼ë¡œ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ì €ì¥ì†Œ ë ˆì´ì–´ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

### 1. ê²€ìƒ‰ ê²°ê³¼ ë¦¬í¬ì§€í† ë¦¬ (repositories/search_repository.py)

#### `save_result(result: SearchResult) -> bool`
- `result.to_dataframe()`ì„ í˜¸ì¶œí•˜ì—¬ DataFrameì„ ì–»ìŠµë‹ˆë‹¤.
- `settings.CSV_PATH` ê²½ë¡œì˜ íŒŒì¼ì— ë°ì´í„°ë¥¼ ì¶”ê°€(append)í•©ë‹ˆë‹¤.
- **êµ¬í˜„ ì„¸ë¶€ì‚¬í•­:**
  - íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ í—¤ë”ë¥¼ í¬í•¨í•˜ì—¬ ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤.
  - íŒŒì¼ì´ ì´ë¯¸ ì¡´ì¬í•˜ë©´ í—¤ë” ì—†ì´ ë°ì´í„°ë¥¼ ì•„ë˜ì— ì¶”ê°€í•©ë‹ˆë‹¤.
  - ì €ì¥ ì‹œ `index=False` ì˜µì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
  - í•œêµ­ì–´ ê¹¨ì§ ë°©ì§€ë¥¼ ìœ„í•´ `encoding="utf-8-sig"`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì„±ê³µ ì‹œ `True`, ì‹¤íŒ¨ ì‹œ `AppError("file_error")`ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.

#### `load_results() -> pd.DataFrame`
- `settings.CSV_PATH` íŒŒì¼ì„ ì½ì–´ ì „ì²´ ê²€ìƒ‰ ì´ë ¥ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
- íŒŒì¼ì´ ì—†ìœ¼ë©´ ë¹ˆ DataFrame(ëª…ì‹œëœ ì»¬ëŸ¼ êµ¬ì¡° í¬í•¨)ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
- ì½ê¸° ì‹¤íŒ¨ ì‹œ `AppError("file_error")`ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.

---

### 2. ë°ì´í„° êµ¬ì¡° (CSV ì»¬ëŸ¼)

ì €ì¥ë˜ëŠ” ë°ì´í„°ëŠ” ë‹¤ìŒ ì»¬ëŸ¼ êµ¬ì¡°ë¥¼ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤:

| ì»¬ëŸ¼ëª… | íƒ€ì… | ì„¤ëª… |
|--------|------|------|
| search_key | string | PK, "í‚¤ì›Œë“œ-yyyymmddhhmm" |
| search_time | datetime | ê²€ìƒ‰ ì‹¤í–‰ ì‹œê°„ |
| keyword | string | ê²€ìƒ‰ í‚¤ì›Œë“œ |
| article_index | int | ê¸°ì‚¬ ìˆœë²ˆ (1ë¶€í„°) |
| title | string | ê¸°ì‚¬ ì œëª© |
| url | string | ê¸°ì‚¬ URL |
| snippet | string | ê¸°ì‚¬ ìŠ¤ë‹ˆí« |
| ai_summary | string | AI ìš”ì•½ ê²°ê³¼ |

**ì°¸ê³ :** `SearchResult.to_dataframe()` ë©”ì„œë“œê°€ ìœ„ êµ¬ì¡°(íŠ¹íˆ `article_index` í¬í•¨)ì— ë§ê²Œ êµ¬í˜„ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

---

### 3. êµ¬í˜„ ìš”êµ¬ì‚¬í•­
- `pandas` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
- `config.settings`ì˜ `CSV_PATH`ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤.
- `utils.exceptions.AppError`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.

---

### 4. ê²€ì¦ ë°©ë²•

```bash
# ë¦¬í¬ì§€í† ë¦¬ import í…ŒìŠ¤íŠ¸
python -c "from repositories.search_repository import save_result, load_results; print('search_repository import ì„±ê³µ')"

# ë°ì´í„° ì €ì¥ í…ŒìŠ¤íŠ¸ (ì„ì‹œ ë°ì´í„° ì‚¬ìš©)
python -c "from domain.search_result import SearchResult; from domain.news_article import NewsArticle; from repositories.search_repository import save_result; from datetime import datetime; res = SearchResult('í…ŒìŠ¤íŠ¸-123', datetime.now(), 'í…ŒìŠ¤íŠ¸', [NewsArticle('ì œëª©', 'url', 'ìŠ¤ë‹ˆí«')], 'ìš”ì•½'); save_result(res); print('ì €ì¥ í…ŒìŠ¤íŠ¸ ì™„ë£Œ')"
```

---

### 5. ê²€ì¦ í¬ì¸íŠ¸

- [ ] `from repositories.search_repository import save_result` import ì„±ê³µ
- [ ] `save_result()` í˜¸ì¶œ ì‹œ CSV íŒŒì¼ì´ ìƒì„±ë˜ê±°ë‚˜ ë°ì´í„°ê°€ ì¶”ê°€ë¨
- [ ] CSV íŒŒì¼ì˜ ì¸ì½”ë”©ì´ `utf-8-sig`ë¡œ ì €ì¥ë˜ì–´ ì—‘ì…€ì—ì„œ í•œê¸€ì´ ê¹¨ì§€ì§€ ì•ŠìŒ
- [ ] `load_results()` í˜¸ì¶œ ì‹œ ì €ì¥ëœ ë°ì´í„°ë¥¼ DataFrameìœ¼ë¡œ ì •ìƒ ë¡œë“œí•¨
- [ ] ì»¬ëŸ¼ëª…ê³¼ ìˆœì„œê°€ ëª…ì„¸ì™€ ì¼ì¹˜í•¨ (article_index í¬í•¨)

---

### âš ï¸ í•„ìˆ˜ ìš”êµ¬ì‚¬í•­: í•œê¸€ ì‚¬ìš©

**ëª¨ë“  ì—ëŸ¬ ë©”ì‹œì§€ì™€ ì•ˆë‚´ í…ìŠ¤íŠ¸ëŠ” í•œê¸€ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.**

---

### ğŸš« ê¸ˆì§€ì‚¬í•­: Git/GitHub ì‘ì—… ê¸ˆì§€

**Git ë° GitHub ê´€ë ¨ ì‘ì—…ì€ ì¼ì ˆ í•˜ì§€ ë§ˆì„¸ìš”.**